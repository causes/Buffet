#!/usr/bin/env ruby

$LOAD_PATH.unshift(File.expand_path(File.dirname(__FILE__) + '/../lib'))

require 'drb/drb'
require 'buffet/settings'

module Buffet
  DRb.start_service

  runner = DRbObject.new_with_uri(Settings.druby_listen_url ARGV[0])
  if runner.can_run?
    puts "Output will be in Campfire when Buffet finishes."
    runner.run
  else
    puts "Someone else is already running Buffet. Chill!"
  end
end
